# 甘特图组件多语言支持实现文档

## 实现概述

本项目已成功为甘特图组件添加了完整的国际化（i18n）支持，支持**中文（简体）**和**英文**两种语言，并且架构具有良好的扩展性，可轻松添加更多语言。

## 已完成的功能

### 1. 国际化核心系统

创建了完整的国际化系统，位于 `src/components/gantt/i18n/` 目录：

- **`index.ts`**: 核心i18n系统
  - `useI18n()`: Vue 3 composition API hook
  - `t(key)`: 翻译函数
  - `setLocale(locale)`: 设置语言
  - `getLocale()`: 获取当前语言
  - `getLocales()`: 获取支持的语言列表
  - 自动保存语言设置到 localStorage

- **`locales/zh-CN.ts`**: 简体中文语言包
  - 包含所有界面文本的中文翻译
  - 涵盖：通用文本、日期时间、视图模式、任务、连线图例、配置面板、主题、提示信息等

- **`locales/en-US.ts`**: 英文语言包
  - 完整的英文翻译
  - 与中文语言包结构完全对应

### 2. 语言切换器组件

创建了 `LanguageSelector.vue` 组件：
- 美观的下拉选择器界面
- 显示当前选择的语言
- 支持动画效果
- 响应式设计，与主题系统集成

### 3. 主组件国际化

**Gantt.vue** 主组件已完全支持多语言：
- ✅ 日期范围选择器（"至"）
- ✅ 视图模式切换按钮（月/周/日/时）
- ✅ 连线图例标题和描述
- ✅ 所有连线类型标签（FS/SS/FF/SF/PC）
- ✅ 集成语言切换器到工具栏

### 4. 配置面板国际化

**GanttConfigPanel.vue** 配置面板已支持多语言：
- ✅ 面板标题
- ✅ 主题设置区域
- ✅ 连线设置区域
- ✅ 所有配置项标签和说明
- ✅ 按钮文本（导出/导入配置）

### 5. 其他组件

- **DatePicker.vue**: 日期选择器
- **TaskRow.vue**: 任务行
- **TaskHeader.vue**: 表头

## 使用说明

### 在组件中使用多语言

```vue
<script setup lang="ts">
import { useI18n } from './i18n';

const { t, locale, setLocale } = useI18n();
</script>

<template>
  <div>
    <!-- 使用翻译函数 -->
    <h1>{{ t('common.title') }}</h1>
    <button>{{ t('common.confirm') }}</button>
  </div>
</template>
```

### 添加新的翻译键

1. 在 `locales/zh-CN.ts` 中添加中文翻译
2. 在 `locales/en-US.ts` 中添加对应的英文翻译
3. 在组件中使用 `t('your.key')` 引用

### 添加新语言

1. 创建新的语言文件，如 `locales/ja-JP.ts`（日语）
2. 在 `i18n/index.ts` 中导入并注册新语言
3. 更新 `getLocales()` 函数添加新语言选项

## 语言包结构

```typescript
export default {
  common: {        // 通用文本
    confirm: '确定',
    cancel: '取消',
    // ...
  },
  date: {          // 日期时间
    year: '年',
    month: '月',
    // ...
  },
  viewMode: {      // 视图模式
    month: '月',
    week: '周',
    // ...
  },
  task: {          // 任务相关
    addRoot: '添加根任务',
    // ...
  },
  link: {          // 连线图例
    legend: '连线图例',
    // ...
  },
  configPanel: {   // 配置面板
    title: '甘特图配置',
    linkConfig: {
      // 连线配置项
    }
  },
  theme: {         // 主题
    metro: 'Metro 金属质感',
    // ...
  }
}
```

## 特性亮点

1. **响应式切换**: 语言切换立即生效，无需刷新页面
2. **持久化保存**: 用户选择的语言自动保存到浏览器本地存储
3. **类型安全**: 使用 TypeScript 提供完整的类型提示
4. **扩展性强**: 轻松添加新语言和新翻译键
5. **统一管理**: 所有翻译文本集中管理，便于维护
6. **主题集成**: 语言切换器样式与主题系统完美集成

## 已翻译的界面元素

### 工具栏区域
- 日期选择器分隔符
- 视图模式按钮（月/周/日/时）
- 连线图例标题和所有连线类型

### 配置面板
- 面板标题和关闭按钮
- 主题设置区域
- 连线配置所有选项
- 颜色、线宽、箭头等配置项

### 任务区域
- 添加/删除任务提示
- 任务表头（序号、任务名称、优先级等）

### 提示信息
- 所有 tooltip 提示文本
- 操作按钮说明

## 技术实现

- **Vue 3 Composition API**: 使用现代化的组合式 API
- **TypeScript**: 完整的类型支持
- **响应式系统**: 基于 Vue 3 的 ref 和 computed
- **模块化设计**: 清晰的文件结构和职责分离
- **性能优化**: 语言切换不会导致组件重新渲染整个应用

## 测试建议

1. 切换语言，检查所有文本是否正确翻译
2. 刷新页面，验证语言设置是否保持
3. 测试不同主题下语言切换器的显示效果
4. 验证新添加的翻译键是否正确显示

## 未来扩展建议

1. 添加更多语言支持（日语、韩语、法语等）
2. 添加日期格式的本地化
3. 添加数字格式的本地化
4. 支持从服务器动态加载语言包
5. 添加语言包缺失提示和降级策略

## 维护指南

1. **添加新文本**: 始终在两个语言文件中同时添加
2. **命名规范**: 使用点号分隔的层级结构，如 `section.subsection.key`
3. **翻译质量**: 确保专业术语翻译准确
4. **测试**: 每次添加新翻译后测试两种语言

## 示例代码

### 使用翻译函数
```vue
<template>
  <button>{{ t('common.confirm') }}</button>
</template>

<script setup lang="ts">
import { useI18n } from './i18n';
const { t } = useI18n();
</script>
```

### 切换语言
```typescript
import { setLocale } from './i18n';

// 切换到英文
setLocale('en-US');

// 切换到中文
setLocale('zh-CN');
```

## 总结

本次实现为甘特图组件提供了完整、专业的多语言支持。通过模块化的设计和清晰的结构，不仅满足了当前的需求，也为未来的扩展奠定了良好的基础。用户可以通过界面上的语言切换器轻松在中英文之间切换，享受流畅的本地化体验。
